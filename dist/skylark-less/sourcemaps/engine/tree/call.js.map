{"version":3,"sources":["engine/tree/call.js"],"names":["define","__module__0","__module__1","__module__2","exports","module","Node","Anonymous","FunctionCaller","Call","name","args","index","currentFileInfo","this","calc","_index","_fileInfo","__isValidToReturn","obj","Array","isArray","attr","__isEmptyObject","prototype","type","accept","visitor","visitArray","eval","context","currentMathContext","mathOn","inCalc","enterCalc","map","a","exitCalc","result","funcCaller","getIndex","fileInfo","isValid","call","e","message","filename","line","lineNumber","column","columnNumber","undefined","toString","genCSS","output","add","i","length"],"mappings":";;;;;;;AAAAA,QACI,SACA,cACA,gCACD,SAAUC,EAAaC,EAAaC,GACnC,aACA,IAAIC,KACAC,GAAWD,YACXE,EAAOL,EAAaM,EAAYL,EAAaM,EAAiBL,EAC9DM,EAAO,SAAUC,EAAMC,EAAMC,EAAOC,GACpCC,KAAKJ,KAAOA,EACZI,KAAKH,KAAOA,EACZG,KAAKC,KAAgB,SAATL,EACZI,KAAKE,OAASJ,EACdE,KAAKG,UAAYJ,GAoErB,SAASK,EAAkBC,GACvB,MAAqB,iBAAPA,GAAmBC,MAAMC,QAAQF,KAPnD,SAAyBA,GACrB,IAAIG,EACJ,IAAKA,KAAQH,EACT,OAAO,EACX,OAAO,EAGiDI,CAAgBJ,GAE5E,OArEAV,EAAKe,UAAY,IAAIlB,GACNmB,KAAO,OACtBhB,EAAKe,UAAUE,OAAS,SAAUC,GAC1Bb,KAAKH,OACLG,KAAKH,KAAOgB,EAAQC,WAAWd,KAAKH,QAG5CF,EAAKe,UAAUK,KAAO,SAAUC,GAC5B,IAAIC,EAAqBD,EAAQE,OACjCF,EAAQE,QAAUlB,KAAKC,MACnBD,KAAKC,MAAQe,EAAQG,SACrBH,EAAQI,YAEZ,IAAIvB,EAAOG,KAAKH,KAAKwB,IAAI,SAAUC,GAC/B,OAAOA,EAAEP,KAAKC,MAEdhB,KAAKC,MAAQe,EAAQG,SACrBH,EAAQO,WAEZP,EAAQE,OAASD,EACjB,IAAIO,EAAQC,EAAa,IAAI/B,EAAeM,KAAKJ,KAAMoB,EAAShB,KAAK0B,WAAY1B,KAAK2B,YACtF,GAAIF,EAAWG,UAAW,CACtB,IACIJ,EAASC,EAAWI,KAAKhC,GAC3B,MAAOiC,GACL,MACInB,KAAMmB,EAAEnB,MAAQ,UAChBoB,QAAS,8BAAgC/B,KAAKJ,KAAO,KAAOkC,EAAEC,QAAU,KAAOD,EAAEC,QAAU,IAC3FjC,MAAOE,KAAK0B,WACZM,SAAUhC,KAAK2B,WAAWK,SAC1BC,KAAMH,EAAEI,WACRC,OAAQL,EAAEM,cAGlB,GAAe,OAAXZ,QAA8Ba,IAAXb,EAUnB,OATMA,aAAkBhC,IAIhBgC,EAAS,IAAI/B,EAHZ+B,IAAqB,IAAXA,EAGYA,EAAOc,WAFP,OAK/Bd,EAAOtB,OAASF,KAAKE,OACrBsB,EAAOrB,UAAYH,KAAKG,UACjBqB,EAGf,OAAO,IAAI7B,EAAKK,KAAKJ,KAAMC,EAAMG,KAAK0B,WAAY1B,KAAK2B,aAE3DhC,EAAKe,UAAU6B,OAAS,SAAUvB,EAASwB,GACvCA,EAAOC,IAAIzC,KAAKJ,KAAO,IAAKI,KAAK2B,WAAY3B,KAAK0B,YAClD,IAAK,IAAIgB,EAAI,EAAGA,EAAI1C,KAAKH,KAAK8C,OAAQD,IAClC1C,KAAKH,KAAK6C,GAAGH,OAAOvB,EAASwB,GACzBE,EAAI,EAAI1C,KAAKH,KAAK8C,QAClBH,EAAOC,IAAI,MAGnBD,EAAOC,IAAI,MAEflD,EAAOD,QAAUK,EAUbS,EAAkBb,EAAOD,SAClBC,EAAOD,QACTc,EAAkBd,GAChBA,OADN","file":"../../../engine/tree/call.js","sourcesContent":["define([\n    './node',\n    './anonymous',\n    '../functions/function-caller'\n], function (__module__0, __module__1, __module__2) {\n    'use strict';\n    var exports = {};\n    var module = { exports: {} };\n    var Node = __module__0, Anonymous = __module__1, FunctionCaller = __module__2;\n    var Call = function (name, args, index, currentFileInfo) {\n        this.name = name;\n        this.args = args;\n        this.calc = name === 'calc';\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n    };\n    Call.prototype = new Node();\n    Call.prototype.type = 'Call';\n    Call.prototype.accept = function (visitor) {\n        if (this.args) {\n            this.args = visitor.visitArray(this.args);\n        }\n    };\n    Call.prototype.eval = function (context) {\n        var currentMathContext = context.mathOn;\n        context.mathOn = !this.calc;\n        if (this.calc || context.inCalc) {\n            context.enterCalc();\n        }\n        var args = this.args.map(function (a) {\n            return a.eval(context);\n        });\n        if (this.calc || context.inCalc) {\n            context.exitCalc();\n        }\n        context.mathOn = currentMathContext;\n        var result, funcCaller = new FunctionCaller(this.name, context, this.getIndex(), this.fileInfo());\n        if (funcCaller.isValid()) {\n            try {\n                result = funcCaller.call(args);\n            } catch (e) {\n                throw {\n                    type: e.type || 'Runtime',\n                    message: 'error evaluating function `' + this.name + '`' + (e.message ? ': ' + e.message : ''),\n                    index: this.getIndex(),\n                    filename: this.fileInfo().filename,\n                    line: e.lineNumber,\n                    column: e.columnNumber\n                };\n            }\n            if (result !== null && result !== undefined) {\n                if (!(result instanceof Node)) {\n                    if (!result || result === true) {\n                        result = new Anonymous(null);\n                    } else {\n                        result = new Anonymous(result.toString());\n                    }\n                }\n                result._index = this._index;\n                result._fileInfo = this._fileInfo;\n                return result;\n            }\n        }\n        return new Call(this.name, args, this.getIndex(), this.fileInfo());\n    };\n    Call.prototype.genCSS = function (context, output) {\n        output.add(this.name + '(', this.fileInfo(), this.getIndex());\n        for (var i = 0; i < this.args.length; i++) {\n            this.args[i].genCSS(context, output);\n            if (i + 1 < this.args.length) {\n                output.add(', ');\n            }\n        }\n        output.add(')');\n    };\n    module.exports = Call;\n    function __isEmptyObject(obj) {\n        var attr;\n        for (attr in obj)\n            return !1;\n        return !0;\n    }\n    function __isValidToReturn(obj) {\n        return typeof obj != 'object' || Array.isArray(obj) || !__isEmptyObject(obj);\n    }\n    if (__isValidToReturn(module.exports))\n        return module.exports;\n    else if (__isValidToReturn(exports))\n        return exports;\n});"]}