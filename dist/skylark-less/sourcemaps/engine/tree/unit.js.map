{"version":3,"sources":["engine/tree/unit.js"],"names":["define","__module__0","__module__1","__module__2","exports","module","unitConversions","utils","Unit","numerator","denominator","backupUnit","this","copyArray","sort","length","__isValidToReturn","obj","Array","isArray","attr","__isEmptyObject","prototype","type","clone","genCSS","context","output","strictUnits","add","toString","i","returnStr","join","compare","other","is","undefined","unitString","toUpperCase","isLength","RegExp","test","toCSS","isEmpty","isSingular","map","callback","usedUnits","group","mapUnit","groupName","result","atomicUnit","hasOwnProperty","cancel","counter","count","push"],"mappings":"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","file":"../../../engine/tree/unit.js","sourcesContent":["define([\n    './node',\n    '../data/unit-conversions',\n    '../utils'\n], function (__module__0, __module__1, __module__2) {\n    'use strict';\n    var exports = {};\n    var module = { exports: {} };\n    var Node = __module__0, unitConversions = __module__1, utils = __module__2;\n    var Unit = function (numerator, denominator, backupUnit) {\n        this.numerator = numerator ? utils.copyArray(numerator).sort() : [];\n        this.denominator = denominator ? utils.copyArray(denominator).sort() : [];\n        if (backupUnit) {\n            this.backupUnit = backupUnit;\n        } else if (numerator && numerator.length) {\n            this.backupUnit = numerator[0];\n        }\n    };\n    Unit.prototype = new Node();\n    Unit.prototype.type = 'Unit';\n    Unit.prototype.clone = function () {\n        return new Unit(utils.copyArray(this.numerator), utils.copyArray(this.denominator), this.backupUnit);\n    };\n    Unit.prototype.genCSS = function (context, output) {\n        var strictUnits = context && context.strictUnits;\n        if (this.numerator.length === 1) {\n            output.add(this.numerator[0]);\n        } else if (!strictUnits && this.backupUnit) {\n            output.add(this.backupUnit);\n        } else if (!strictUnits && this.denominator.length) {\n            output.add(this.denominator[0]);\n        }\n    };\n    Unit.prototype.toString = function () {\n        var i, returnStr = this.numerator.join('*');\n        for (i = 0; i < this.denominator.length; i++) {\n            returnStr += '/' + this.denominator[i];\n        }\n        return returnStr;\n    };\n    Unit.prototype.compare = function (other) {\n        return this.is(other.toString()) ? 0 : undefined;\n    };\n    Unit.prototype.is = function (unitString) {\n        return this.toString().toUpperCase() === unitString.toUpperCase();\n    };\n    Unit.prototype.isLength = function () {\n        return RegExp('^(px|em|ex|ch|rem|in|cm|mm|pc|pt|ex|vw|vh|vmin|vmax)$', 'gi').test(this.toCSS());\n    };\n    Unit.prototype.isEmpty = function () {\n        return this.numerator.length === 0 && this.denominator.length === 0;\n    };\n    Unit.prototype.isSingular = function () {\n        return this.numerator.length <= 1 && this.denominator.length === 0;\n    };\n    Unit.prototype.map = function (callback) {\n        var i;\n        for (i = 0; i < this.numerator.length; i++) {\n            this.numerator[i] = callback(this.numerator[i], false);\n        }\n        for (i = 0; i < this.denominator.length; i++) {\n            this.denominator[i] = callback(this.denominator[i], true);\n        }\n    };\n    Unit.prototype.usedUnits = function () {\n        var group, result = {}, mapUnit, groupName;\n        mapUnit = function (atomicUnit) {\n            if (group.hasOwnProperty(atomicUnit) && !result[groupName]) {\n                result[groupName] = atomicUnit;\n            }\n            return atomicUnit;\n        };\n        for (groupName in unitConversions) {\n            if (unitConversions.hasOwnProperty(groupName)) {\n                group = unitConversions[groupName];\n                this.map(mapUnit);\n            }\n        }\n        return result;\n    };\n    Unit.prototype.cancel = function () {\n        var counter = {}, atomicUnit, i;\n        for (i = 0; i < this.numerator.length; i++) {\n            atomicUnit = this.numerator[i];\n            counter[atomicUnit] = (counter[atomicUnit] || 0) + 1;\n        }\n        for (i = 0; i < this.denominator.length; i++) {\n            atomicUnit = this.denominator[i];\n            counter[atomicUnit] = (counter[atomicUnit] || 0) - 1;\n        }\n        this.numerator = [];\n        this.denominator = [];\n        for (atomicUnit in counter) {\n            if (counter.hasOwnProperty(atomicUnit)) {\n                var count = counter[atomicUnit];\n                if (count > 0) {\n                    for (i = 0; i < count; i++) {\n                        this.numerator.push(atomicUnit);\n                    }\n                } else if (count < 0) {\n                    for (i = 0; i < -count; i++) {\n                        this.denominator.push(atomicUnit);\n                    }\n                }\n            }\n        }\n        this.numerator.sort();\n        this.denominator.sort();\n    };\n    module.exports = Unit;\n    function __isEmptyObject(obj) {\n        var attr;\n        for (attr in obj)\n            return !1;\n        return !0;\n    }\n    function __isValidToReturn(obj) {\n        return typeof obj != 'object' || Array.isArray(obj) || !__isEmptyObject(obj);\n    }\n    if (__isValidToReturn(module.exports))\n        return module.exports;\n    else if (__isValidToReturn(exports))\n        return exports;\n});"]}