{"version":3,"sources":["engine/tree/extend.js"],"names":["define","__module__0","__module__1","exports","module","Node","Selector","Extend","selector","option","index","currentFileInfo","visibilityInfo","this","object_id","next_id","parent_ids","_index","_fileInfo","copyVisibilityInfo","allowRoot","allowBefore","allowAfter","setParent","__isValidToReturn","obj","Array","isArray","attr","__isEmptyObject","prototype","type","accept","visitor","visit","eval","context","getIndex","fileInfo","clone","findSelfSelectors","selectors","i","selectorElements","selfElements","length","elements","combinator","value","concat","selfSelectors"],"mappings":";;;;;;;AAAAA,QACI,SACA,cACD,SAAUC,EAAaC,GACtB,aACA,IAAIC,KACAC,GAAWD,YACXE,EAAOJ,EAAaK,EAAWJ,EAC/BK,EAAS,SAASA,EAAOC,EAAUC,EAAQC,EAAOC,EAAiBC,GASnE,OARAC,KAAKL,SAAWA,EAChBK,KAAKJ,OAASA,EACdI,KAAKC,UAAYP,EAAOQ,UACxBF,KAAKG,YAAcH,KAAKC,WACxBD,KAAKI,OAASP,EACdG,KAAKK,UAAYP,EACjBE,KAAKM,mBAAmBP,GACxBC,KAAKO,WAAY,EACTX,GACR,IAAK,MACDI,KAAKQ,aAAc,EACnBR,KAAKS,YAAa,EAClB,MACJ,QACIT,KAAKQ,aAAc,EACnBR,KAAKS,YAAa,EAGtBT,KAAKU,UAAUV,KAAKL,SAAUK,OAiClC,SAASW,EAAkBC,GACvB,MAAqB,iBAAPA,GAAmBC,MAAMC,QAAQF,KAPnD,SAAyBA,GACrB,IAAIG,EACJ,IAAKA,KAAQH,EACT,OAAO,EACX,OAAO,EAGiDI,CAAgBJ,GAE5E,OAlCAlB,EAAOQ,QAAU,GACjBR,EAAOuB,UAAY,IAAIzB,GACN0B,KAAO,SACxBxB,EAAOuB,UAAUE,OAAS,SAAUC,GAChCpB,KAAKL,SAAWyB,EAAQC,MAAMrB,KAAKL,WAEvCD,EAAOuB,UAAUK,KAAO,SAAUC,GAC9B,OAAO,IAAI7B,EAAOM,KAAKL,SAAS2B,KAAKC,GAAUvB,KAAKJ,OAAQI,KAAKwB,WAAYxB,KAAKyB,WAAYzB,KAAKD,mBAEvGL,EAAOuB,UAAUS,MAAQ,SAAUH,GAC/B,OAAO,IAAI7B,EAAOM,KAAKL,SAAUK,KAAKJ,OAAQI,KAAKwB,WAAYxB,KAAKyB,WAAYzB,KAAKD,mBAEzFL,EAAOuB,UAAUU,kBAAoB,SAAUC,GAC3C,IAAuBC,EAAGC,EAAtBC,KACJ,IAAKF,EAAI,EAAGA,EAAID,EAAUI,OAAQH,IAC9BC,EAAmBF,EAAUC,GAAGI,SAC5BJ,EAAI,GAAKC,EAAiBE,QAAmD,KAAzCF,EAAiB,GAAGI,WAAWC,QACnEL,EAAiB,GAAGI,WAAWC,MAAQ,KAE3CJ,EAAeA,EAAaK,OAAOR,EAAUC,GAAGI,UAEpDjC,KAAKqC,eAAiB,IAAI5C,EAASsC,IACnC/B,KAAKqC,cAAc,GAAG/B,mBAAmBN,KAAKD,mBAElDR,EAAOD,QAAUI,EAUbiB,EAAkBpB,EAAOD,SAClBC,EAAOD,QACTqB,EAAkBrB,GAChBA,OADN","file":"../../../engine/tree/extend.js","sourcesContent":["define([\n    './node',\n    './selector'\n], function (__module__0, __module__1) {\n    'use strict';\n    var exports = {};\n    var module = { exports: {} };\n    var Node = __module__0, Selector = __module__1;\n    var Extend = function Extend(selector, option, index, currentFileInfo, visibilityInfo) {\n        this.selector = selector;\n        this.option = option;\n        this.object_id = Extend.next_id++;\n        this.parent_ids = [this.object_id];\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.copyVisibilityInfo(visibilityInfo);\n        this.allowRoot = true;\n        switch (option) {\n        case 'all':\n            this.allowBefore = true;\n            this.allowAfter = true;\n            break;\n        default:\n            this.allowBefore = false;\n            this.allowAfter = false;\n            break;\n        }\n        this.setParent(this.selector, this);\n    };\n    Extend.next_id = 0;\n    Extend.prototype = new Node();\n    Extend.prototype.type = 'Extend';\n    Extend.prototype.accept = function (visitor) {\n        this.selector = visitor.visit(this.selector);\n    };\n    Extend.prototype.eval = function (context) {\n        return new Extend(this.selector.eval(context), this.option, this.getIndex(), this.fileInfo(), this.visibilityInfo());\n    };\n    Extend.prototype.clone = function (context) {\n        return new Extend(this.selector, this.option, this.getIndex(), this.fileInfo(), this.visibilityInfo());\n    };\n    Extend.prototype.findSelfSelectors = function (selectors) {\n        var selfElements = [], i, selectorElements;\n        for (i = 0; i < selectors.length; i++) {\n            selectorElements = selectors[i].elements;\n            if (i > 0 && selectorElements.length && selectorElements[0].combinator.value === '') {\n                selectorElements[0].combinator.value = ' ';\n            }\n            selfElements = selfElements.concat(selectors[i].elements);\n        }\n        this.selfSelectors = [new Selector(selfElements)];\n        this.selfSelectors[0].copyVisibilityInfo(this.visibilityInfo());\n    };\n    module.exports = Extend;\n    function __isEmptyObject(obj) {\n        var attr;\n        for (attr in obj)\n            return !1;\n        return !0;\n    }\n    function __isValidToReturn(obj) {\n        return typeof obj != 'object' || Array.isArray(obj) || !__isEmptyObject(obj);\n    }\n    if (__isValidToReturn(module.exports))\n        return module.exports;\n    else if (__isValidToReturn(exports))\n        return exports;\n});"]}