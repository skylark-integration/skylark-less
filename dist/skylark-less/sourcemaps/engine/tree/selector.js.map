{"version":3,"sources":["engine/tree/selector.js"],"names":["define","__module__0","__module__1","__module__2","exports","module","Element","LessError","Selector","elements","extendList","condition","index","currentFileInfo","visibilityInfo","this","evaldCondition","_index","_fileInfo","getElements","mixinElements_","undefined","copyVisibilityInfo","setParent","__isValidToReturn","obj","Array","isArray","attr","__isEmptyObject","prototype","type","accept","visitor","visitArray","visit","createDerived","newSelector","getIndex","fileInfo","mediaEmpty","els","parse","parseNode","err","result","message","imports","filename","createEmptySelectors","el","sels","match","other","olen","i","len","length","mixinElements","value","map","v","combinator","join","shift","isJustParentSelector","eval","context","e","extend","genCSS","output","firstSelector","add","getIsOutput"],"mappings":"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","file":"../../../engine/tree/selector.js","sourcesContent":["define([\n    './node',\n    './element',\n    '../less-error'\n], function (__module__0, __module__1, __module__2) {\n    'use strict';\n    var exports = {};\n    var module = { exports: {} };\n    var Node = __module__0, Element = __module__1, LessError = __module__2;\n    var Selector = function (elements, extendList, condition, index, currentFileInfo, visibilityInfo) {\n        this.extendList = extendList;\n        this.condition = condition;\n        this.evaldCondition = !condition;\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.elements = this.getElements(elements);\n        this.mixinElements_ = undefined;\n        this.copyVisibilityInfo(visibilityInfo);\n        this.setParent(this.elements, this);\n    };\n    Selector.prototype = new Node();\n    Selector.prototype.type = 'Selector';\n    Selector.prototype.accept = function (visitor) {\n        if (this.elements) {\n            this.elements = visitor.visitArray(this.elements);\n        }\n        if (this.extendList) {\n            this.extendList = visitor.visitArray(this.extendList);\n        }\n        if (this.condition) {\n            this.condition = visitor.visit(this.condition);\n        }\n    };\n    Selector.prototype.createDerived = function (elements, extendList, evaldCondition) {\n        elements = this.getElements(elements);\n        var newSelector = new Selector(elements, extendList || this.extendList, null, this.getIndex(), this.fileInfo(), this.visibilityInfo());\n        newSelector.evaldCondition = evaldCondition != null ? evaldCondition : this.evaldCondition;\n        newSelector.mediaEmpty = this.mediaEmpty;\n        return newSelector;\n    };\n    Selector.prototype.getElements = function (els) {\n        if (!els) {\n            return [new Element('', '&', false, this._index, this._fileInfo)];\n        }\n        if (typeof els === 'string') {\n            this.parse.parseNode(els, ['selector'], this._index, this._fileInfo, function (err, result) {\n                if (err) {\n                    throw new LessError({\n                        index: err.index,\n                        message: err.message\n                    }, this.parse.imports, this._fileInfo.filename);\n                }\n                els = result[0].elements;\n            });\n        }\n        return els;\n    };\n    Selector.prototype.createEmptySelectors = function () {\n        var el = new Element('', '&', false, this._index, this._fileInfo), sels = [new Selector([el], null, null, this._index, this._fileInfo)];\n        sels[0].mediaEmpty = true;\n        return sels;\n    };\n    Selector.prototype.match = function (other) {\n        var elements = this.elements, len = elements.length, olen, i;\n        other = other.mixinElements();\n        olen = other.length;\n        if (olen === 0 || len < olen) {\n            return 0;\n        } else {\n            for (i = 0; i < olen; i++) {\n                if (elements[i].value !== other[i]) {\n                    return 0;\n                }\n            }\n        }\n        return olen;\n    };\n    Selector.prototype.mixinElements = function () {\n        if (this.mixinElements_) {\n            return this.mixinElements_;\n        }\n        var elements = this.elements.map(function (v) {\n            return v.combinator.value + (v.value.value || v.value);\n        }).join('').match(/[,&#\\*\\.\\w-]([\\w-]|(\\\\.))*/g);\n        if (elements) {\n            if (elements[0] === '&') {\n                elements.shift();\n            }\n        } else {\n            elements = [];\n        }\n        return this.mixinElements_ = elements;\n    };\n    Selector.prototype.isJustParentSelector = function () {\n        return !this.mediaEmpty && this.elements.length === 1 && this.elements[0].value === '&' && (this.elements[0].combinator.value === ' ' || this.elements[0].combinator.value === '');\n    };\n    Selector.prototype.eval = function (context) {\n        var evaldCondition = this.condition && this.condition.eval(context), elements = this.elements, extendList = this.extendList;\n        elements = elements && elements.map(function (e) {\n            return e.eval(context);\n        });\n        extendList = extendList && extendList.map(function (extend) {\n            return extend.eval(context);\n        });\n        return this.createDerived(elements, extendList, evaldCondition);\n    };\n    Selector.prototype.genCSS = function (context, output) {\n        var i, element;\n        if ((!context || !context.firstSelector) && this.elements[0].combinator.value === '') {\n            output.add(' ', this.fileInfo(), this.getIndex());\n        }\n        for (i = 0; i < this.elements.length; i++) {\n            element = this.elements[i];\n            element.genCSS(context, output);\n        }\n    };\n    Selector.prototype.getIsOutput = function () {\n        return this.evaldCondition;\n    };\n    module.exports = Selector;\n    function __isEmptyObject(obj) {\n        var attr;\n        for (attr in obj)\n            return !1;\n        return !0;\n    }\n    function __isValidToReturn(obj) {\n        return typeof obj != 'object' || Array.isArray(obj) || !__isEmptyObject(obj);\n    }\n    if (__isValidToReturn(module.exports))\n        return module.exports;\n    else if (__isValidToReturn(exports))\n        return exports;\n});"]}