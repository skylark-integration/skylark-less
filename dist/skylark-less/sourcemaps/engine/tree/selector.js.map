{"version":3,"sources":["engine/tree/selector.js"],"names":["Node","require","Element","LessError","Selector","elements","extendList","condition","index","currentFileInfo","visibilityInfo","this","evaldCondition","_index","_fileInfo","getElements","mixinElements_","undefined","copyVisibilityInfo","setParent","prototype","type","accept","visitor","visitArray","visit","createDerived","newSelector","getIndex","fileInfo","mediaEmpty","els","parse","parseNode","err","result","message","imports","filename","createEmptySelectors","el","sels","match","other","olen","i","len","length","mixinElements","value","map","v","combinator","join","shift","isJustParentSelector","eval","context","e","extend","genCSS","output","firstSelector","add","getIsOutput","module","exports"],"mappings":"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","file":"../../../engine/tree/selector.js","sourcesContent":["var Node = require('./node'), Element = require('./element'), LessError = require('../less-error');\nvar Selector = function (elements, extendList, condition, index, currentFileInfo, visibilityInfo) {\n    this.extendList = extendList;\n    this.condition = condition;\n    this.evaldCondition = !condition;\n    this._index = index;\n    this._fileInfo = currentFileInfo;\n    this.elements = this.getElements(elements);\n    this.mixinElements_ = undefined;\n    this.copyVisibilityInfo(visibilityInfo);\n    this.setParent(this.elements, this);\n};\nSelector.prototype = new Node();\nSelector.prototype.type = 'Selector';\nSelector.prototype.accept = function (visitor) {\n    if (this.elements) {\n        this.elements = visitor.visitArray(this.elements);\n    }\n    if (this.extendList) {\n        this.extendList = visitor.visitArray(this.extendList);\n    }\n    if (this.condition) {\n        this.condition = visitor.visit(this.condition);\n    }\n};\nSelector.prototype.createDerived = function (elements, extendList, evaldCondition) {\n    elements = this.getElements(elements);\n    var newSelector = new Selector(elements, extendList || this.extendList, null, this.getIndex(), this.fileInfo(), this.visibilityInfo());\n    newSelector.evaldCondition = evaldCondition != null ? evaldCondition : this.evaldCondition;\n    newSelector.mediaEmpty = this.mediaEmpty;\n    return newSelector;\n};\nSelector.prototype.getElements = function (els) {\n    if (!els) {\n        return [new Element('', '&', false, this._index, this._fileInfo)];\n    }\n    if (typeof els === 'string') {\n        this.parse.parseNode(els, ['selector'], this._index, this._fileInfo, function (err, result) {\n            if (err) {\n                throw new LessError({\n                    index: err.index,\n                    message: err.message\n                }, this.parse.imports, this._fileInfo.filename);\n            }\n            els = result[0].elements;\n        });\n    }\n    return els;\n};\nSelector.prototype.createEmptySelectors = function () {\n    var el = new Element('', '&', false, this._index, this._fileInfo), sels = [new Selector([el], null, null, this._index, this._fileInfo)];\n    sels[0].mediaEmpty = true;\n    return sels;\n};\nSelector.prototype.match = function (other) {\n    var elements = this.elements, len = elements.length, olen, i;\n    other = other.mixinElements();\n    olen = other.length;\n    if (olen === 0 || len < olen) {\n        return 0;\n    } else {\n        for (i = 0; i < olen; i++) {\n            if (elements[i].value !== other[i]) {\n                return 0;\n            }\n        }\n    }\n    return olen;\n};\nSelector.prototype.mixinElements = function () {\n    if (this.mixinElements_) {\n        return this.mixinElements_;\n    }\n    var elements = this.elements.map(function (v) {\n        return v.combinator.value + (v.value.value || v.value);\n    }).join('').match(/[,&#\\*\\.\\w-]([\\w-]|(\\\\.))*/g);\n    if (elements) {\n        if (elements[0] === '&') {\n            elements.shift();\n        }\n    } else {\n        elements = [];\n    }\n    return this.mixinElements_ = elements;\n};\nSelector.prototype.isJustParentSelector = function () {\n    return !this.mediaEmpty && this.elements.length === 1 && this.elements[0].value === '&' && (this.elements[0].combinator.value === ' ' || this.elements[0].combinator.value === '');\n};\nSelector.prototype.eval = function (context) {\n    var evaldCondition = this.condition && this.condition.eval(context), elements = this.elements, extendList = this.extendList;\n    elements = elements && elements.map(function (e) {\n        return e.eval(context);\n    });\n    extendList = extendList && extendList.map(function (extend) {\n        return extend.eval(context);\n    });\n    return this.createDerived(elements, extendList, evaldCondition);\n};\nSelector.prototype.genCSS = function (context, output) {\n    var i, element;\n    if ((!context || !context.firstSelector) && this.elements[0].combinator.value === '') {\n        output.add(' ', this.fileInfo(), this.getIndex());\n    }\n    for (i = 0; i < this.elements.length; i++) {\n        element = this.elements[i];\n        element.genCSS(context, output);\n    }\n};\nSelector.prototype.getIsOutput = function () {\n    return this.evaldCondition;\n};\nmodule.exports = Selector;"]}