{"version":3,"sources":["engine/visitors/import-sequencer.js"],"names":["define","exports","module","ImportSequencer","onSequencerEmpty","this","imports","variableImports","_onSequencerEmpty","_currentDepth","__isValidToReturn","obj","Array","isArray","attr","__isEmptyObject","prototype","addImport","callback","importSequencer","importItem","args","isReady","push","slice","call","arguments","tryRun","addVariableImport","length","apply","variableImport"],"mappings":";;;;;;;AAAAA,UAAW,WACP,aACA,IAAIC,KACAC,GAAWD,YACf,SAASE,EAAgBC,GACrBC,KAAKC,WACLD,KAAKE,mBACLF,KAAKG,kBAAoBJ,EACzBC,KAAKI,cAAgB,EAmDzB,SAASC,EAAkBC,GACvB,MAAqB,iBAAPA,GAAmBC,MAAMC,QAAQF,KAPnD,SAAyBA,GACrB,IAAIG,EACJ,IAAKA,KAAQH,EACT,OAAO,EACX,OAAO,EAGiDI,CAAgBJ,GAE5E,OApDAR,EAAgBa,UAAUC,UAAY,SAAUC,GAC5C,IAAIC,EAAkBd,KAAMe,GACpBF,SAAUA,EACVG,KAAM,KACNC,SAAS,GAGjB,OADAjB,KAAKC,QAAQiB,KAAKH,GACX,WACHA,EAAWC,KAAOT,MAAMI,UAAUQ,MAAMC,KAAKC,UAAW,GACxDN,EAAWE,SAAU,EACrBH,EAAgBQ,WAGxBxB,EAAgBa,UAAUY,kBAAoB,SAAUV,GACpDb,KAAKE,gBAAgBgB,KAAKL,IAE9Bf,EAAgBa,UAAUW,OAAS,WAC/BtB,KAAKI,gBACL,IACI,OAAa,CACT,KAAOJ,KAAKC,QAAQuB,OAAS,GAAG,CAC5B,IAAIT,EAAaf,KAAKC,QAAQ,GAC9B,IAAKc,EAAWE,QACZ,OAEJjB,KAAKC,QAAUD,KAAKC,QAAQkB,MAAM,GAClCJ,EAAWF,SAASY,MAAM,KAAMV,EAAWC,MAE/C,GAAoC,IAAhChB,KAAKE,gBAAgBsB,OACrB,MAEJ,IAAIE,EAAiB1B,KAAKE,gBAAgB,GAC1CF,KAAKE,gBAAkBF,KAAKE,gBAAgBiB,MAAM,GAClDO,KAEN,QACE1B,KAAKI,gBAEkB,IAAvBJ,KAAKI,eAAuBJ,KAAKG,mBACjCH,KAAKG,qBAGbN,EAAOD,QAAUE,EAUbO,EAAkBR,EAAOD,SAClBC,EAAOD,QACTS,EAAkBT,GAChBA,OADN","file":"../../../engine/visitors/import-sequencer.js","sourcesContent":["define([], function () {\n    'use strict';\n    var exports = {};\n    var module = { exports: {} };\n    function ImportSequencer(onSequencerEmpty) {\n        this.imports = [];\n        this.variableImports = [];\n        this._onSequencerEmpty = onSequencerEmpty;\n        this._currentDepth = 0;\n    }\n    ImportSequencer.prototype.addImport = function (callback) {\n        var importSequencer = this, importItem = {\n                callback: callback,\n                args: null,\n                isReady: false\n            };\n        this.imports.push(importItem);\n        return function () {\n            importItem.args = Array.prototype.slice.call(arguments, 0);\n            importItem.isReady = true;\n            importSequencer.tryRun();\n        };\n    };\n    ImportSequencer.prototype.addVariableImport = function (callback) {\n        this.variableImports.push(callback);\n    };\n    ImportSequencer.prototype.tryRun = function () {\n        this._currentDepth++;\n        try {\n            while (true) {\n                while (this.imports.length > 0) {\n                    var importItem = this.imports[0];\n                    if (!importItem.isReady) {\n                        return;\n                    }\n                    this.imports = this.imports.slice(1);\n                    importItem.callback.apply(null, importItem.args);\n                }\n                if (this.variableImports.length === 0) {\n                    break;\n                }\n                var variableImport = this.variableImports[0];\n                this.variableImports = this.variableImports.slice(1);\n                variableImport();\n            }\n        } finally {\n            this._currentDepth--;\n        }\n        if (this._currentDepth === 0 && this._onSequencerEmpty) {\n            this._onSequencerEmpty();\n        }\n    };\n    module.exports = ImportSequencer;\n    function __isEmptyObject(obj) {\n        var attr;\n        for (attr in obj)\n            return !1;\n        return !0;\n    }\n    function __isValidToReturn(obj) {\n        return typeof obj != 'object' || Array.isArray(obj) || !__isEmptyObject(obj);\n    }\n    if (__isValidToReturn(module.exports))\n        return module.exports;\n    else if (__isValidToReturn(exports))\n        return exports;\n});"]}