{"version":3,"sources":["engine/plugin-manager.js"],"names":["pm","PluginManager","less","this","visitors","preProcessors","postProcessors","installedPlugins","fileManagers","iterator","pluginCache","Loader","PluginLoader","PluginManagerFactory","newFactory","prototype","addPlugins","plugins","i","length","addPlugin","plugin","filename","functionRegistry","push","install","functions","get","addVisitor","visitor","addPreProcessor","preProcessor","priority","indexToInsertAt","splice","addPostProcessor","postProcessor","addFileManager","manager","getPreProcessors","getPostProcessors","getVisitors","self","first","getFileManagers","module","exports"],"mappings":";;;;;;;AAAA,IAWIA,GAXAC,cAAgB,SAAUC,GAC1BC,KAAKD,KAAOA,EACZC,KAAKC,YACLD,KAAKE,iBACLF,KAAKG,kBACLH,KAAKI,oBACLJ,KAAKK,gBACLL,KAAKM,UAAY,EACjBN,KAAKO,eACLP,KAAKQ,OAAS,IAAIT,EAAKU,aAAaV,IAEhCW,qBAAuB,SAAUX,EAAMY,GAIvC,OAHIA,GAAed,KACfA,GAAK,IAAIC,cAAcC,IAEpBF,IAEfC,cAAcc,UAAUC,WAAa,SAAUC,GAC3C,GAAIA,EACA,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAQE,OAAQD,IAChCf,KAAKiB,UAAUH,EAAQC,KAInCjB,cAAcc,UAAUK,UAAY,SAAUC,EAAQC,EAAUC,GAC5DpB,KAAKI,iBAAiBiB,KAAKH,GACvBC,IACAnB,KAAKO,YAAYY,GAAYD,GAE7BA,EAAOI,SACPJ,EAAOI,QAAQtB,KAAKD,KAAMC,KAAMoB,GAAoBpB,KAAKD,KAAKwB,UAAUH,mBAGhFtB,cAAcc,UAAUY,IAAM,SAAUL,GACpC,OAAOnB,KAAKO,YAAYY,IAE5BrB,cAAcc,UAAUa,WAAa,SAAUC,GAC3C1B,KAAKC,SAASoB,KAAKK,IAEvB5B,cAAcc,UAAUe,gBAAkB,SAAUC,EAAcC,GAC9D,IAAIC,EACJ,IAAKA,EAAkB,EAAGA,EAAkB9B,KAAKE,cAAcc,UACvDhB,KAAKE,cAAc4B,GAAiBD,UAAYA,GADeC,KAKvE9B,KAAKE,cAAc6B,OAAOD,EAAiB,GACvCF,aAAcA,EACdC,SAAUA,KAGlB/B,cAAcc,UAAUoB,iBAAmB,SAAUC,EAAeJ,GAChE,IAAIC,EACJ,IAAKA,EAAkB,EAAGA,EAAkB9B,KAAKG,eAAea,UACxDhB,KAAKG,eAAe2B,GAAiBD,UAAYA,GADeC,KAKxE9B,KAAKG,eAAe4B,OAAOD,EAAiB,GACxCG,cAAeA,EACfJ,SAAUA,KAGlB/B,cAAcc,UAAUsB,eAAiB,SAAUC,GAC/CnC,KAAKK,aAAagB,KAAKc,IAE3BrC,cAAcc,UAAUwB,iBAAmB,WAEvC,IADA,IAAIlC,KACKa,EAAI,EAAGA,EAAIf,KAAKE,cAAcc,OAAQD,IAC3Cb,EAAcmB,KAAKrB,KAAKE,cAAca,GAAGa,cAE7C,OAAO1B,GAEXJ,cAAcc,UAAUyB,kBAAoB,WAExC,IADA,IAAIlC,KACKY,EAAI,EAAGA,EAAIf,KAAKG,eAAea,OAAQD,IAC5CZ,EAAekB,KAAKrB,KAAKG,eAAeY,GAAGkB,eAE/C,OAAO9B,GAEXL,cAAcc,UAAU0B,YAAc,WAClC,OAAOtC,KAAKC,UAEhBH,cAAcc,UAAUc,QAAU,WAC9B,IAAIa,EAAOvC,KACX,OACIwC,MAAO,WAEH,OADAD,EAAKjC,UAAY,EACViC,EAAKtC,SAASsC,EAAKjC,WAE9BkB,IAAK,WAED,OADAe,EAAKjC,UAAY,EACViC,EAAKtC,SAASsC,EAAKjC,aAItCR,cAAcc,UAAU6B,gBAAkB,WACtC,OAAOzC,KAAKK,cAEhBqC,OAAOC,QAAUjC","file":"../../engine/plugin-manager.js","sourcesContent":["var PluginManager = function (less) {\n    this.less = less;\n    this.visitors = [];\n    this.preProcessors = [];\n    this.postProcessors = [];\n    this.installedPlugins = [];\n    this.fileManagers = [];\n    this.iterator = -1;\n    this.pluginCache = {};\n    this.Loader = new less.PluginLoader(less);\n};\nvar pm, PluginManagerFactory = function (less, newFactory) {\n        if (newFactory || !pm) {\n            pm = new PluginManager(less);\n        }\n        return pm;\n    };\nPluginManager.prototype.addPlugins = function (plugins) {\n    if (plugins) {\n        for (var i = 0; i < plugins.length; i++) {\n            this.addPlugin(plugins[i]);\n        }\n    }\n};\nPluginManager.prototype.addPlugin = function (plugin, filename, functionRegistry) {\n    this.installedPlugins.push(plugin);\n    if (filename) {\n        this.pluginCache[filename] = plugin;\n    }\n    if (plugin.install) {\n        plugin.install(this.less, this, functionRegistry || this.less.functions.functionRegistry);\n    }\n};\nPluginManager.prototype.get = function (filename) {\n    return this.pluginCache[filename];\n};\nPluginManager.prototype.addVisitor = function (visitor) {\n    this.visitors.push(visitor);\n};\nPluginManager.prototype.addPreProcessor = function (preProcessor, priority) {\n    var indexToInsertAt;\n    for (indexToInsertAt = 0; indexToInsertAt < this.preProcessors.length; indexToInsertAt++) {\n        if (this.preProcessors[indexToInsertAt].priority >= priority) {\n            break;\n        }\n    }\n    this.preProcessors.splice(indexToInsertAt, 0, {\n        preProcessor: preProcessor,\n        priority: priority\n    });\n};\nPluginManager.prototype.addPostProcessor = function (postProcessor, priority) {\n    var indexToInsertAt;\n    for (indexToInsertAt = 0; indexToInsertAt < this.postProcessors.length; indexToInsertAt++) {\n        if (this.postProcessors[indexToInsertAt].priority >= priority) {\n            break;\n        }\n    }\n    this.postProcessors.splice(indexToInsertAt, 0, {\n        postProcessor: postProcessor,\n        priority: priority\n    });\n};\nPluginManager.prototype.addFileManager = function (manager) {\n    this.fileManagers.push(manager);\n};\nPluginManager.prototype.getPreProcessors = function () {\n    var preProcessors = [];\n    for (var i = 0; i < this.preProcessors.length; i++) {\n        preProcessors.push(this.preProcessors[i].preProcessor);\n    }\n    return preProcessors;\n};\nPluginManager.prototype.getPostProcessors = function () {\n    var postProcessors = [];\n    for (var i = 0; i < this.postProcessors.length; i++) {\n        postProcessors.push(this.postProcessors[i].postProcessor);\n    }\n    return postProcessors;\n};\nPluginManager.prototype.getVisitors = function () {\n    return this.visitors;\n};\nPluginManager.prototype.visitor = function () {\n    var self = this;\n    return {\n        first: function () {\n            self.iterator = -1;\n            return self.visitors[self.iterator];\n        },\n        get: function () {\n            self.iterator += 1;\n            return self.visitors[self.iterator];\n        }\n    };\n};\nPluginManager.prototype.getFileManagers = function () {\n    return this.fileManagers;\n};\nmodule.exports = PluginManagerFactory;"]}