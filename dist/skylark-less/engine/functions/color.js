/**
 * skylark-less - A version of less.js that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-less/
 * @license MIT
 */
define(["../tree/dimension","../tree/color","../tree/quoted","../tree/anonymous","./function-registry"],function(r,n,e,t,a){"use strict";var u,o={},i={},l=r,v=n,f=e,s=t;function c(r){return Math.min(1,Math.max(0,r))}function g(r,n){var e=u.hsla(n.h,n.s,n.l,n.a);if(e)return r.value&&/^(rgb|hsl)/.test(r.value)?e.value=r.value:e.value="rgb",e}function h(r){if(r instanceof l)return parseFloat(r.unit.is("%")?r.value/100:r.value);if("number"==typeof r)return r;throw{type:"Argument",message:"color functions take numbers as parameters"}}function b(r){return"object"!=typeof r||Array.isArray(r)||!function(r){var n;for(n in r)return!1;return!0}(r)}return u={rgb:function(r,n,e){var t=u.rgba(r,n,e,1);if(t)return t.value="rgb",t},rgba:function(r,n,e,t){try{if(r instanceof v)return t=n?h(n):r.alpha,new v(r.rgb,t,"rgba");var a=[r,n,e].map(function(r){return e=255,(n=r)instanceof l&&n.unit.is("%")?parseFloat(n.value*e/100):h(n);var n,e});return t=h(t),new v(a,t,"rgba")}catch(r){}},hsl:function(r,n,e){var t=u.hsla(r,n,e,1);if(t)return t.value="hsl",t},hsla:function(r,n,e,t){try{if(r instanceof v)return t=n?h(n):r.alpha,new v(r.rgb,t,"hsla");var a,u;function o(r){return 6*(r=r<0?r+1:r>1?r-1:r)<1?a+(u-a)*r*6:2*r<1?u:3*r<2?a+(u-a)*(2/3-r)*6:a}r=h(r)%360/360,n=c(h(n)),e=c(h(e)),t=c(h(t)),a=2*e-(u=e<=.5?e*(n+1):e+n-e*n);var i=[255*o(r+1/3),255*o(r),255*o(r-1/3)];return t=h(t),new v(i,t,"hsla")}catch(r){}},hsv:function(r,n,e){return u.hsva(r,n,e,1)},hsva:function(r,n,e,t){var a,o;r=h(r)%360/360*360,n=h(n),e=h(e),t=h(t);var i=[e,e*(1-n),e*(1-(o=r/60-(a=Math.floor(r/60%6)))*n),e*(1-(1-o)*n)],l=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]];return u.rgba(255*i[l[a][0]],255*i[l[a][1]],255*i[l[a][2]],t)},hue:function(r){return new l(r.toHSL().h)},saturation:function(r){return new l(100*r.toHSL().s,"%")},lightness:function(r){return new l(100*r.toHSL().l,"%")},hsvhue:function(r){return new l(r.toHSV().h)},hsvsaturation:function(r){return new l(100*r.toHSV().s,"%")},hsvvalue:function(r){return new l(100*r.toHSV().v,"%")},red:function(r){return new l(r.rgb[0])},green:function(r){return new l(r.rgb[1])},blue:function(r){return new l(r.rgb[2])},alpha:function(r){return new l(r.toHSL().a)},luma:function(r){return new l(r.luma()*r.alpha*100,"%")},luminance:function(r){var n=.2126*r.rgb[0]/255+.7152*r.rgb[1]/255+.0722*r.rgb[2]/255;return new l(n*r.alpha*100,"%")},saturate:function(r,n,e){if(!r.rgb)return null;var t=r.toHSL();return void 0!==e&&"relative"===e.value?t.s+=t.s*n.value/100:t.s+=n.value/100,t.s=c(t.s),g(r,t)},desaturate:function(r,n,e){var t=r.toHSL();return void 0!==e&&"relative"===e.value?t.s-=t.s*n.value/100:t.s-=n.value/100,t.s=c(t.s),g(r,t)},lighten:function(r,n,e){var t=r.toHSL();return void 0!==e&&"relative"===e.value?t.l+=t.l*n.value/100:t.l+=n.value/100,t.l=c(t.l),g(r,t)},darken:function(r,n,e){var t=r.toHSL();return void 0!==e&&"relative"===e.value?t.l-=t.l*n.value/100:t.l-=n.value/100,t.l=c(t.l),g(r,t)},fadein:function(r,n,e){var t=r.toHSL();return void 0!==e&&"relative"===e.value?t.a+=t.a*n.value/100:t.a+=n.value/100,t.a=c(t.a),g(r,t)},fadeout:function(r,n,e){var t=r.toHSL();return void 0!==e&&"relative"===e.value?t.a-=t.a*n.value/100:t.a-=n.value/100,t.a=c(t.a),g(r,t)},fade:function(r,n){var e=r.toHSL();return e.a=n.value/100,e.a=c(e.a),g(r,e)},spin:function(r,n){var e=r.toHSL(),t=(e.h+n.value)%360;return e.h=t<0?360+t:t,g(r,e)},mix:function(r,n,e){r.toHSL&&n.toHSL||(console.log(n.type),console.dir(n)),e||(e=new l(50));var t=e.value/100,a=2*t-1,u=r.toHSL().a-n.toHSL().a,o=((a*u==-1?a:(a+u)/(1+a*u))+1)/2,i=1-o,f=[r.rgb[0]*o+n.rgb[0]*i,r.rgb[1]*o+n.rgb[1]*i,r.rgb[2]*o+n.rgb[2]*i],s=r.alpha*t+n.alpha*(1-t);return new v(f,s)},greyscale:function(r){return u.desaturate(r,new l(100))},contrast:function(r,n,e,t){if(!r.rgb)return null;if(void 0===e&&(e=u.rgba(255,255,255,1)),void 0===n&&(n=u.rgba(0,0,0,1)),n.luma()>e.luma()){var a=e;e=n,n=a}return t=void 0===t?.43:h(t),r.luma()<t?e:n},argb:function(r){return new s(r.toARGB())},color:function(r){if(r instanceof f&&/^#([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3,4})$/i.test(r.value)){var n=r.value.slice(1);return new v(n,void 0,"#"+n)}if(r instanceof v||(r=v.fromKeyword(r.value)))return r.value=void 0,r;throw{type:"Argument",message:"argument must be a color keyword or 3|4|6|8 digit hex e.g. #FFF"}},tint:function(r,n){return u.mix(u.rgb(255,255,255),r,n)},shade:function(r,n){return u.mix(u.rgb(0,0,0),r,n)}},a.addMultiple(u),b(i)?i:b(o)?o:void 0});
//# sourceMappingURL=../../sourcemaps/engine/functions/color.js.map
