/**
 * skylark-less - A version of less.js that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-less/
 * @license MIT
 */
define(["./node","../data/unit-conversions","./unit","./color"],function(t,n,i,e){"use strict";var r={},o={exports:{}},u=t,s=n,a=i,c=e,h=function(t,n){if(this.value=parseFloat(t),isNaN(this.value))throw new Error("Dimension is not a number.");this.unit=n&&n instanceof a?n:new a(n?[n]:void 0),this.setParent(this.unit,this)};function p(t){return"object"!=typeof t||Array.isArray(t)||!function(t){var n;for(n in t)return!1;return!0}(t)}return(h.prototype=new u).type="Dimension",h.prototype.accept=function(t){this.unit=t.visit(this.unit)},h.prototype.eval=function(t){return this},h.prototype.toColor=function(){return new c([this.value,this.value,this.value])},h.prototype.genCSS=function(t,n){if(t&&t.strictUnits&&!this.unit.isSingular())throw new Error("Multiple units in dimension. Correct the units or use the unit function. Bad unit: "+this.unit.toString());var i=this.fround(t,this.value),e=String(i);if(0!==i&&i<1e-6&&i>-1e-6&&(e=i.toFixed(20).replace(/0+$/,"")),t&&t.compress){if(0===i&&this.unit.isLength())return void n.add(e);i>0&&i<1&&(e=e.substr(1))}n.add(e),this.unit.genCSS(t,n)},h.prototype.operate=function(t,n,i){var e=this._operate(t,n,this.value,i.value),r=this.unit.clone();if("+"===n||"-"===n)if(0===r.numerator.length&&0===r.denominator.length)r=i.unit.clone(),this.unit.backupUnit&&(r.backupUnit=this.unit.backupUnit);else if(0===i.unit.numerator.length&&0===r.denominator.length);else{if(i=i.convertTo(this.unit.usedUnits()),t.strictUnits&&i.unit.toString()!==r.toString())throw new Error("Incompatible units. Change the units or use the unit function. Bad units: '"+r.toString()+"' and '"+i.unit.toString()+"'.");e=this._operate(t,n,this.value,i.value)}else"*"===n?(r.numerator=r.numerator.concat(i.unit.numerator).sort(),r.denominator=r.denominator.concat(i.unit.denominator).sort(),r.cancel()):"/"===n&&(r.numerator=r.numerator.concat(i.unit.denominator).sort(),r.denominator=r.denominator.concat(i.unit.numerator).sort(),r.cancel());return new h(e,r)},h.prototype.compare=function(t){var n,i;if(t instanceof h){if(this.unit.isEmpty()||t.unit.isEmpty())n=this,i=t;else if(n=this.unify(),i=t.unify(),0!==n.unit.compare(i.unit))return;return u.numericCompare(n.value,i.value)}},h.prototype.unify=function(){return this.convertTo({length:"px",duration:"s",angle:"rad"})},h.prototype.convertTo=function(t){var n,i,e,r,o,u=this.value,a=this.unit.clone(),c={};if("string"==typeof t){for(n in s)s[n].hasOwnProperty(t)&&((c={})[n]=t);t=c}for(i in o=function(t,n){return e.hasOwnProperty(t)?(n?u/=e[t]/e[r]:u*=e[t]/e[r],r):t},t)t.hasOwnProperty(i)&&(r=t[i],e=s[i],a.map(o));return a.cancel(),new h(u,a)},o.exports=h,p(o.exports)?o.exports:p(r)?r:void 0});
//# sourceMappingURL=../../sourcemaps/engine/tree/dimension.js.map
